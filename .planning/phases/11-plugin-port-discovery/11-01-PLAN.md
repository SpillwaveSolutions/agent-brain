---
phase: 11-plugin-port-discovery
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - agent-brain-plugin/skills/using-agent-brain/references/troubleshooting-guide.md
  - agent-brain-plugin/skills/using-agent-brain/references/server-discovery.md
  - agent-brain-cli/README.md
  - docs/QUICK_START.md
  - docs/DEVELOPERS_GUIDE.md
  - docs/USER_GUIDE.md
  - docs/PLUGIN_GUIDE.md
  - CLAUDE.md
  - .planning/ROADMAP.md
  - .planning/REQUIREMENTS.md
autonomous: true

must_haves:
  truths:
    - "All active documentation references .claude/agent-brain/ (not .claude/doc-serve/)"
    - "ROADMAP.md success criteria reflect actual version 6.0.3 (not 6.0.2)"
    - "Requirements PLUG-07, PLUG-08, INFRA-06 are verifiably satisfied in the codebase"
    - "Requirements PLUG-07, PLUG-08, INFRA-06 are marked [x] in REQUIREMENTS.md"
    - "task before-push passes with zero failures"
  artifacts:
    - path: "agent-brain-plugin/skills/using-agent-brain/references/troubleshooting-guide.md"
      provides: "Updated troubleshooting guide with .claude/agent-brain/ paths"
      contains: ".claude/agent-brain/"
    - path: "agent-brain-plugin/skills/using-agent-brain/references/server-discovery.md"
      provides: "Updated server discovery guide with .claude/agent-brain/ paths"
      contains: ".claude/agent-brain/"
    - path: "agent-brain-cli/README.md"
      provides: "Updated CLI README with .claude/agent-brain/ path"
      contains: ".claude/agent-brain/"
    - path: "docs/QUICK_START.md"
      provides: "Updated quick start with .claude/agent-brain/ path"
      contains: ".claude/agent-brain/"
    - path: "CLAUDE.md"
      provides: "Updated project instructions with .claude/agent-brain/ path"
      contains: ".claude/agent-brain/"
    - path: "docs/DEVELOPERS_GUIDE.md"
      provides: "Updated developer guide with .claude/agent-brain/ paths"
      contains: ".claude/agent-brain/"
    - path: "docs/USER_GUIDE.md"
      provides: "Updated user guide with .claude/agent-brain/ path"
      contains: ".claude/agent-brain/"
    - path: "docs/PLUGIN_GUIDE.md"
      provides: "Updated plugin guide with .claude/agent-brain/ paths"
      contains: ".claude/agent-brain/"
    - path: ".planning/REQUIREMENTS.md"
      provides: "Updated requirement statuses for PLUG-07, PLUG-08, INFRA-06"
      contains: "[x] **PLUG-07**"
  key_links:
    - from: "agent-brain-plugin/skills/using-agent-brain/references/server-discovery.md"
      to: ".claude/agent-brain/runtime.json"
      via: "file path references in discovery code and docs"
      pattern: "\\.claude/agent-brain/runtime\\.json"
    - from: "agent-brain-plugin/skills/using-agent-brain/references/troubleshooting-guide.md"
      to: ".claude/agent-brain/"
      via: "file path references for cleanup instructions"
      pattern: "\\.claude/agent-brain/"
---

<objective>
Fix stale `.claude/doc-serve/` path references in 8 active documentation files, update ROADMAP.md success criteria to reflect actual v6.0.3, mark requirements as done in REQUIREMENTS.md, and verify the full codebase passes quality checks.

Purpose: Phase 11 requirements (PLUG-07, PLUG-08, INFRA-06) are already satisfied in code. The remaining work is documentation cleanup of stale path references, formal requirement closure, and verification that everything works. This closes the v6.0.2 milestone.

Output: Updated documentation files, verified ROADMAP.md, updated REQUIREMENTS.md, clean `task before-push`.
</objective>

<execution_context>
@/Users/richardhightower/.claude/get-shit-done/workflows/execute-plan.md
@/Users/richardhightower/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/11-plugin-port-discovery/11-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix stale .claude/doc-serve/ path references in active documentation</name>
  <files>
    agent-brain-plugin/skills/using-agent-brain/references/troubleshooting-guide.md
    agent-brain-plugin/skills/using-agent-brain/references/server-discovery.md
    agent-brain-cli/README.md
    docs/QUICK_START.md
    docs/DEVELOPERS_GUIDE.md
    docs/USER_GUIDE.md
    docs/PLUGIN_GUIDE.md
    CLAUDE.md
  </files>
  <action>
    Replace all `.claude/doc-serve/` references with `.claude/agent-brain/` in the 8 active documentation files listed above.

    Specific replacements per file:

    1. **troubleshooting-guide.md** (4 occurrences):
       - Line 249: `cat .claude/doc-serve/runtime.json` -> `cat .claude/agent-brain/runtime.json`
       - Line 315: `rm .claude/doc-serve/runtime.json` -> `rm .claude/agent-brain/runtime.json`
       - Line 316: `rm .claude/doc-serve/lock.json` -> `rm .claude/agent-brain/lock.json`
       - Line 317: `rm .claude/doc-serve/pid` -> `rm .claude/agent-brain/pid`
       - Line 345: `rm .claude/doc-serve/lock.json` -> `rm .claude/agent-brain/lock.json`

    2. **server-discovery.md** (5 occurrences):
       - Line 17: `.claude/doc-serve/runtime.json` -> `.claude/agent-brain/runtime.json`
       - Line 45: `.claude/doc-serve/runtime.json` -> `.claude/agent-brain/runtime.json`
       - Line 76 (Python code): `"doc-serve"` -> `"agent-brain"` in the Path construction
       - Line 169: `rm .claude/doc-serve/runtime.json` -> `rm .claude/agent-brain/runtime.json`
       - Line 185: `cat .claude/doc-serve/runtime.json` -> `cat .claude/agent-brain/runtime.json`

    3. **agent-brain-cli/README.md** (1 occurrence):
       - Line 86: `creates .claude/doc-serve/` -> `creates .claude/agent-brain/`

    4. **docs/QUICK_START.md** (1 occurrence):
       - Line 53: `.claude/doc-serve/` -> `.claude/agent-brain/`

    5. **CLAUDE.md** (1 occurrence):
       - Line 160: `creates .claude/doc-serve/` -> `creates .claude/agent-brain/`

    6. **docs/DEVELOPERS_GUIDE.md** (2 occurrences):
       - Line 200: `.claude/doc-serve/` -> `.claude/agent-brain/`
       - Line 255: `.claude/doc-serve/config.json` -> `.claude/agent-brain/config.json`

    7. **docs/USER_GUIDE.md** (1 occurrence):
       - Line 435: `.claude/doc-serve/` -> `.claude/agent-brain/`

    8. **docs/PLUGIN_GUIDE.md** (2 occurrences):
       - Line 262: `.claude/doc-serve/` -> `.claude/agent-brain/`
       - Line 527: `.claude/doc-serve/runtime.json` -> `.claude/agent-brain/runtime.json`

    DO NOT modify these files (they are historical/legacy and document what was true at the time):
    - .speckit/features/* (spec history)
    - docs/roadmaps/* (legacy roadmap documents)
    - docs/MIGRATION.md (explicitly documents the old path as migration context)
    - docs/design/* (design documents)
    - .gitignore (should keep .claude/doc-serve/ pattern for backwards compatibility)
  </action>
  <verify>
    Run: `grep -r '\.claude/doc-serve/' --include="*.md" . | grep -v '.speckit/' | grep -v 'docs/roadmaps/' | grep -v 'docs/MIGRATION.md' | grep -v 'docs/design/' | grep -v '.planning/' | grep -v '.claude/skills/installing-local/SKILL.md'`

    Expected: No output (zero matches in active docs). The `.planning/` exclusion is intentional — planning files are internal records that reference historical paths and should not be modified.

    Also verify the replacements are correct:
    `grep -r '\.claude/agent-brain/' agent-brain-plugin/skills/using-agent-brain/references/server-discovery.md agent-brain-plugin/skills/using-agent-brain/references/troubleshooting-guide.md agent-brain-cli/README.md docs/QUICK_START.md CLAUDE.md docs/DEVELOPERS_GUIDE.md docs/USER_GUIDE.md docs/PLUGIN_GUIDE.md`

    Expected: Multiple matches showing the new path in each file.
  </verify>
  <done>All 8 active documentation files use `.claude/agent-brain/` instead of `.claude/doc-serve/`. Historical/legacy files remain unchanged.</done>
</task>

<task type="auto">
  <name>Task 2: Update ROADMAP.md success criteria, mark requirements done, and verify</name>
  <files>
    .planning/ROADMAP.md
    .planning/REQUIREMENTS.md
  </files>
  <action>
    **Part A: Update ROADMAP.md**

    Update the Phase 11 section in ROADMAP.md:

    1. Change success criteria #4 from "Plugin version bumped to 6.0.2" to "Plugin version at 6.0.3 (exceeds 6.0.2 target)"
    2. Change success criteria #5 from "Local install works: `agent-brain --version` returns 6.0.2" to "Local install works: `agent-brain --version` returns 6.0.3"
    3. Change success criteria #7 from "v6.0.2 released to PyPI" to "v6.0.3 released to PyPI (supersedes 6.0.2)"
    4. Update the plan line from `- [ ] 11-01-PLAN.md — install.sh fix, version bumps, port auto-discovery in plugin commands, local install, E2E validation, release` to `- [ ] 11-01-PLAN.md — doc path cleanup, version verification, requirement closure`

    **Part B: Mark requirements as done in REQUIREMENTS.md**

    In .planning/REQUIREMENTS.md, update these three requirement checkboxes from `[ ]` to `[x]`:

    1. Line 71: `- [ ] **PLUG-07**` -> `- [x] **PLUG-07**`
    2. Line 72: `- [ ] **PLUG-08**` -> `- [x] **PLUG-08**`
    3. Line 75: `- [ ] **INFRA-06**` -> `- [x] **INFRA-06**`

    Also update the Traceability table (lines 156-158):
    - `| PLUG-07 | Phase 11 | Pending |` -> `| PLUG-07 | Phase 11 | Done |`
    - `| PLUG-08 | Phase 11 | Pending |` -> `| PLUG-08 | Phase 11 | Done |`
    - `| INFRA-06 | Phase 11 | Pending |` -> `| INFRA-06 | Phase 11 | Done |`

    **Part C: Structural verification of requirements in codebase**

    Verify all three requirements are structurally satisfied (confirm the code/config exists — functional correctness was already validated in prior phases and confirmed by research):

    - PLUG-07: Confirm port auto-discovery exists in agent-brain-plugin/commands/agent-brain-setup.md and agent-brain-plugin/commands/agent-brain-config.md (grep for "5432" range scanning)
    - PLUG-08: Confirm plugin version is 6.0.3 in agent-brain-plugin/.claude-plugin/plugin.json
    - INFRA-06: Confirm install.sh uses "agent-brain" not "doc-serve" for REPO_ROOT

    Print verification results to stdout for the summary.
  </action>
  <verify>
    1. Read ROADMAP.md and confirm success criteria mention 6.0.3
    2. Run: `grep -c "6.0.3" .planning/ROADMAP.md` — should show at least 3 matches in Phase 11 section
    3. Run: `grep "REPO_ROOT" .claude/skills/installing-local/install.sh` — should show "agent-brain"
    4. Run: `grep "version" agent-brain-plugin/.claude-plugin/plugin.json` — should show 6.0.3
    5. Run: `grep -c "5432" agent-brain-plugin/commands/agent-brain-setup.md` — should be >= 1
    6. Run: `grep '\[x\] \*\*PLUG-07\*\*' .planning/REQUIREMENTS.md` — should match
    7. Run: `grep '\[x\] \*\*PLUG-08\*\*' .planning/REQUIREMENTS.md` — should match
    8. Run: `grep '\[x\] \*\*INFRA-06\*\*' .planning/REQUIREMENTS.md` — should match
    9. Run: `grep 'PLUG-07.*Done' .planning/REQUIREMENTS.md` — should match in traceability table
  </verify>
  <done>ROADMAP.md success criteria updated to reflect v6.0.3. All three requirements (PLUG-07, PLUG-08, INFRA-06) structurally verified as satisfied in the codebase and marked [x] done in REQUIREMENTS.md with traceability table updated to "Done".</done>
</task>

<task type="auto">
  <name>Task 3: Run quality gate and verify no regressions</name>
  <files></files>
  <action>
    Run `task before-push` from the repo root to verify all quality checks pass:
    - Black formatting
    - Ruff linting
    - mypy type checking
    - pytest tests

    This is a verification-only task. No code changes.

    If any checks fail, investigate and fix. Common issues:
    - Line length > 88 chars: run `black` to auto-fix
    - Import order: run `ruff check --fix`
    - Missing type stubs: install with `uv pip install types-XXX`

    Note: Only Python source files are checked. The documentation changes from Task 1 do not affect this check, but we verify here that no existing code is broken.
  </action>
  <verify>
    `task before-push` exits with code 0. All formatters, linters, type checkers, and tests pass.
  </verify>
  <done>`task before-push` passes cleanly. Zero formatting, linting, type, or test failures. The codebase is in a shippable state.</done>
</task>

</tasks>

<verification>
1. `grep -r '\.claude/doc-serve/' --include="*.md" . | grep -v '.speckit/' | grep -v 'docs/roadmaps/' | grep -v 'docs/MIGRATION.md' | grep -v 'docs/design/' | grep -v '.planning/' | grep -v '.claude/skills/'` returns empty (no stale active refs). The `.planning/` exclusion is intentional — planning files are internal records referencing historical paths.
2. ROADMAP.md Phase 11 success criteria reference v6.0.3
3. REQUIREMENTS.md has PLUG-07, PLUG-08, INFRA-06 marked as [x] and traceability shows "Done"
4. `task before-push` exits 0
5. All three requirements structurally verified: PLUG-07 (port discovery in plugin), PLUG-08 (version 6.0.3), INFRA-06 (install.sh paths correct)
</verification>

<success_criteria>
- All 8 active documentation files updated from .claude/doc-serve/ to .claude/agent-brain/
- ROADMAP.md Phase 11 success criteria reflect actual v6.0.3 version
- Requirements PLUG-07, PLUG-08, INFRA-06 verified as satisfied and marked [x] in REQUIREMENTS.md
- task before-push passes with zero failures
- Phase 11 is ready to be marked complete
</success_criteria>

<output>
After completion, create `.planning/phases/11-plugin-port-discovery/11-01-SUMMARY.md`
</output>
